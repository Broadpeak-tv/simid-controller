"use strict";!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("shakaSmartLibModule",[],t):"object"==typeof exports?exports.shakaSmartLibModule=t():e.shakaSmartLibModule=t()}("undefined"!=typeof self?self:global,(function(){return(("undefined"!=typeof self?self:global).webpackChunkSmartLibModule=("undefined"!=typeof self?self:global).webpackChunkSmartLibModule||[]).push([[37],{2706:function(e,t,i){i.r(t),i.d(t,{ShakaPlayerAdapter:function(){return E}});i(4338),i(7195),i(752),i(228),i(1694),i(1090),i(6265),i(9373),i(9903),i(9749),i(6544),i(9288),i(8052),i(6034),i(50);var r=i(9393),n=i(7780),a=i(7960);function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,y(r.key),r)}}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,r=h(e);if(t){var n=h(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}(this,i)}}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function d(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}function c(e,t,i){return(t=y(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function y(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function f(e,t,i){return function(e,t,i){if(t.set)t.set.call(e,i);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=i}}(e,p(e,t,"set"),i),i}function v(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,p(e,t,"get"))}function p(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance");return t.get(e)}var g="BpkShakaPlayerAdapter",P=new WeakMap,b=new WeakMap,E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(y,e);var t,i,n,h=l(y);function y(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y);for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return d(u(e=h.call.apply(h,[this].concat(i))),P,{writable:!0,value:void 0}),d(u(e),b,{writable:!0,value:void 0}),c(u(e),"loading",void 0),c(u(e),"started",void 0),c(u(e),"bitrate",void 0),c(u(e),"playingEventReceived",void 0),c(u(e),"requestedURLReceived",void 0),c(u(e),"redirectedURLReceived",void 0),c(u(e),"loadingError",void 0),c(u(e),"playerStateManager",void 0),c(u(e),"playerListeners",void 0),e}return t=y,n=[{key:"attachLibrary",value:function(e){void 0!==e.util&&void 0!==e.Player?(r.oR.d(g,"Shaka Player library attached"),y.library=e):r.oR.e(g,"Try to attach a library, but it is not recognized")}},{key:"checkPlayer",value:function(e,t){if("undefined"!=typeof window&&void 0!==window.shaka&&(y.library=window.shaka),"function"==typeof e.getConfiguration){var i=e.getConfiguration();if(void 0!==i.manifest&&void 0!==i.streaming)return!0}return!1}}],(i=[{key:"onPlayEvent",value:function(){this.started&&this.notifyResume()}},{key:"onPlayingEvent",value:function(){this.playingEventReceived=!0,this.started||(v(this,P).isBuffering()?r.oR.d(g,"Player is still buffering, first image event not yet triggered"):(this.started=!0,this.playerStateManager.start(),this.notifyFirstImage()))}},{key:"onPauseEvent",value:function(){this.notifyPause()}},{key:"onBuffering",value:function(){var e=v(this,P).isBuffering();if(!0===r.$2.getInstance().isAnalyticsInitialized()&&!1===this.requestedURLReceived){this.requestedURLReceived=!0;var t,i=v(this,P).getAssetUri();null!=i?(r.oR.d(g,"Requested URL: "+i),this.setCustomParameter("report.requestedURL",i)):(r.oR.d(g,"Playback not started"),void 0!==this.loadingError&&(t=this.getErrorCode(this.loadingError),this.setPlayerErrorCode(this.loadingError.code)),this.notifyClose(t))}this.started?e?(void 0!==this.playerStateManager&&this.playerStateManager.forcePollPlayerPosition(),this.notifyStallStart()):(this.notifyStallEnd(),this.setStatusCode(r.$2.BPSessionEndsNormally),this.setPlayerErrorCode("")):!e&&this.playingEventReceived&&(this.started=!0,this.playerStateManager.start(),this.notifyFirstImage())}},{key:"onLayerSwitchEvent",value:function(){var e=this.getBitrate();e!==this.bitrate&&(this.bitrate=e,this.notifyLayerSwitch(e))}},{key:"onVariantChanged",value:function(){this.onLayerSwitchEvent()}},{key:"onLoadingEvent",value:function(){!1===this.loading&&(this.loading=!0,this.notifyLoading())}},{key:"onStateChangeEvent",value:function(e){"unload"===e.state&&this.notifyClose()}},{key:"onNetworkResponseEvent",value:function(e,t){0===e&&!0===r.$2.getInstance().isAnalyticsInitialized()&&!1===this.redirectedURLReceived&&(this.redirectedURLReceived=!0,r.oR.d(g,"Resolved redirected URL: "+t.uri),this.setCustomParameter("report.redirectedURL",t.uri))}},{key:"handleSeek",value:function(e,t){this.notifySeek(e,t)}},{key:"onErrorEvent",value:function(e){e.detail.severity===y.library.util.Error.Severity.CRITICAL&&(r.oR.e(g,"On player error : "+e.detail.code),this.setStatusCode(this.getErrorCode(e.detail)),this.setPlayerErrorCode(e.detail.code))}},{key:"getName",value:function(){return"Shaka Player"}},{key:"getVersion",value:function(){var e=y.library.Player.version.substring(0,32),t=e.indexOf(" ");return t>=0?e.substring(0,t):e}},{key:"getMediaElement",value:function(){return v(this,P).getMediaElement()}},{key:"getBitrate",value:function(){if(void 0!==v(this,P))for(var e=v(this,P).getVariantTracks(),t=0;t<e.length;t++){var i=e[t];if(!0===i.active)return Math.round(i.bandwidth/1e3)}return 0}},{key:"getPosition",value:function(){return void 0!==v(this,P)?Math.round(1e3*v(this,P).getMediaElement().currentTime):0}},{key:"getDuration",value:function(){return void 0===v(this,P)||v(this,P).isLive()?0:Math.round(1e3*v(this,P).getMediaElement().duration)}},{key:"getCapabilities",value:function(){return{adTracking:!0}}},{key:"getErrorCode",value:function(e){switch(e.category){case y.library.util.Error.Category.NETWORK:return r.$2.BPNetworkingError;case y.library.util.Error.Category.TEXT:case y.library.util.Error.Category.MEDIA:case y.library.util.Error.Category.MANIFEST:return r.$2.BPFormatNotSupportedError;case y.library.util.Error.Category.STREAMING:return r.$2.BPDecodingError;case y.library.util.Error.Category.DRM:return r.$2.BPAccessRightError;case y.library.util.Error.Category.PLAYER:case y.library.util.Error.Category.CAST:case y.library.util.Error.Category.STORAGE:default:return r.$2.BPUnspecifiedError}}},{key:"setLoadingError",value:function(e){this.loadingError=e}},{key:"initSessionPlayerObjects",value:function(){this.loading=!1,this.started=!1,this.bitrate=0,this.playingEventReceived=!1,this.requestedURLReceived=!1,this.redirectedURLReceived=!1,this.loadingError=void 0,void 0!==v(this,P)&&(void 0!==this.playerStateManager&&this.playerStateManager.stop(),this.playerStateManager=new a.Z(this,this),this.playerListeners=[this.onPlayEvent.bind(this),this.onPauseEvent.bind(this),this.onBuffering.bind(this),this.onLayerSwitchEvent.bind(this),this.onErrorEvent.bind(this),this.onPlayingEvent.bind(this),this.onVariantChanged.bind(this),this.onLoadingEvent.bind(this),this.onStateChangeEvent.bind(this),this.onNetworkResponseEvent.bind(this)],v(this,P).getMediaElement().addEventListener("play",this.playerListeners[0]),v(this,P).getMediaElement().addEventListener("pause",this.playerListeners[1]),v(this,P).addEventListener("buffering",this.playerListeners[2]),v(this,P).addEventListener("adaptation",this.playerListeners[3]),v(this,P).addEventListener("error",this.playerListeners[4]),v(this,P).getMediaElement().addEventListener("playing",this.playerListeners[5]),v(this,P).addEventListener("variantchanged",this.playerListeners[6]),v(this,P).addEventListener("loading",this.playerListeners[7]),v(this,P).addEventListener("onstatechange",this.playerListeners[8]),v(this,P).getNetworkingEngine().registerResponseFilter(this.playerListeners[9]))}},{key:"releaseSessionPlayerObjects",value:function(){void 0!==this.playerStateManager&&(this.playerStateManager.stop(),this.playerStateManager=void 0),void 0!==v(this,P)&&void 0!==this.playerListeners&&this.playerListeners.length>0&&(v(this,P).getMediaElement().removeEventListener("play",this.playerListeners[0]),v(this,P).getMediaElement().removeEventListener("pause",this.playerListeners[1]),v(this,P).removeEventListener("buffering",this.playerListeners[2]),v(this,P).removeEventListener("adaptation",this.playerListeners[3]),v(this,P).removeEventListener("error",this.playerListeners[4]),v(this,P).getMediaElement().removeEventListener("playing",this.playerListeners[5]),v(this,P).removeEventListener("variantchanged",this.playerListeners[6]),v(this,P).removeEventListener("loading",this.playerListeners[7]),v(this,P).removeEventListener("onstatechange",this.playerListeners[8]),v(this,P).getNetworkingEngine().unregisterResponseFilter(this.playerListeners[9]))}},{key:"attachPlayer",value:function(e,t){return!!y.checkPlayer(e,t)&&(void 0===y.library&&r.oR.e(g,"Player library not attached to the adapter, please call ShakaPlayerAdapter.attachLibrary(shaka) before attachPlayer"),f(this,P,e),f(this,b,t),!0)}},{key:"detachPlayer",value:function(){this.releaseSessionPlayerObjects(),f(this,P,void 0),f(this,b,void 0)}}])&&o(t.prototype,i),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),y}(n.y4);c(E,"library",void 0),i(5911).Z.shakaModule={ShakaPlayerAdapter:E}},7960:function(e,t,i){i.d(t,{Z:function(){return s}});i(9373),i(9903),i(9749),i(6544),i(228),i(9288);var r=i(9393);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function a(e,t,i){return(t=o(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function o(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a(this,"playerAdapter",void 0),a(this,"listener",void 0),a(this,"pollPeriod",void 0),a(this,"pollLastDate",void 0),a(this,"pollPlayerInterval",void 0),a(this,"lastPosition",void 0),a(this,"expectedPosition",void 0),this.playerAdapter=t,this.listener=i,this.pollPeriod=e.POLLING_PERIOD,this.pollPlayerInterval=null,this.expectedPosition=0,this.pollLastDate=0}var t,i,o;return t=e,(i=[{key:"start",value:function(){var e=this;this.lastPosition=this.playerAdapter.getPosition(),this.expectedPosition=this.lastPosition+this.pollPeriod,this.pollLastDate=Date.now(),null!==this.pollPlayerInterval&&clearInterval(this.pollPlayerInterval),this.pollPlayerInterval=setInterval((function(){e.pollPlayerPosition()}),this.pollPeriod)}},{key:"stop",value:function(){null!==this.pollPlayerInterval&&(clearInterval(this.pollPlayerInterval),this.pollPlayerInterval=null)}},{key:"forcePollPlayerPosition",value:function(){this.expectedPosition=this.expectedPosition-this.pollPeriod+(Date.now()-this.pollLastDate),this.pollPlayerPosition()}},{key:"pollPlayerPosition",value:function(){this.lastPosition=this.playerAdapter.getPosition();var e=this.expectedPosition+2*this.pollPeriod,t=this.expectedPosition-2*this.pollPeriod;(this.lastPosition<t||this.lastPosition>e)&&void 0!==this.listener&&"function"==typeof this.listener.handleSeek&&!0===this.listener.handleSeek(this.expectedPosition,this.lastPosition)&&r.oR.d("BpkPlayerStateManager","Player is seeking ("+r.ED.formatTime(this.expectedPosition)+" to "+r.ED.formatTime(this.lastPosition)+")"),this.expectedPosition=this.lastPosition+this.pollPeriod,void 0!==this.listener&&"function"==typeof this.listener.handlePoll&&this.listener.handlePoll(),this.pollLastDate=Date.now()}},{key:"getPositionBeforeSeek",value:function(){return this.lastPosition}}])&&n(t.prototype,i),o&&n(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();a(s,"POLLING_PERIOD",500)},4338:function(e,t,i){var r=i(9989),n=i(3689),a=i(2297),o=i(8999),s=i(690),l=i(6310),u=i(5565),h=i(6522),d=i(7120),c=i(9042),y=i(4201),f=i(3615),v=y("isConcatSpreadable"),p=f>=51||!n((function(){var e=[];return e[v]=!1,e.concat()[0]!==e})),g=function(e){if(!o(e))return!1;var t=e[v];return void 0!==t?!!t:a(e)};r({target:"Array",proto:!0,arity:1,forced:!p||!c("concat")},{concat:function(e){var t,i,r,n,a,o=s(this),c=d(o,0),y=0;for(t=-1,r=arguments.length;t<r;t++)if(g(a=-1===t?o:arguments[t]))for(n=l(a),u(y+n),i=0;i<n;i++,y++)i in a&&h(c,y,a[i]);else u(y+1),h(c,y++,a);return c.length=y,c}})}},function(e){return e.O(0,[142],(function(){return t=2706,e(e.s=t);var t})),e.O()}])}));