"use strict";!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("simidSmartLibModule",[],t):"object"==typeof exports?exports.simidSmartLibModule=t():e.simidSmartLibModule=t()}("undefined"!=typeof self?self:global,(function(){return(("undefined"!=typeof self?self:global).webpackChunkSmartLibModule=("undefined"!=typeof self?self:global).webpackChunkSmartLibModule||[]).push([[19],{6464:function(e,t,r){r.r(t),r.d(t,{BrowserSimidControllerAdapter:function(){return se},GenericSimidControllerApi:function(){return J},SimidControllerManager:function(){return g},SimidControllerManagerHandler:function(){return Y}});var n=r(3557),o=(r(2675),r(9463),r(2259),r(5700),r(3792),r(9572),r(2892),r(6099),r(7764),r(3772),r(2953),r(3914));function i(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function a(e,t,r){return e.set(s(e,t),r),r}function l(e,t){return e.get(s(e,t))}function s(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m(n.key),n)}}function d(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function m(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==u(t)?t:t+""}var p="BpkSimidControllerMgr",y=function(){return d((function e(){c(this,e)}),null,[{key:"loadSimidControllerAdapters",value:function(){return{}}}])}(),v=new WeakMap,b=new WeakMap,h=new WeakMap,g=function(){function e(){var t,r,n;c(this,e),t=this,n=void 0,(r=m(r="smartLib"))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,i(this,v,y),i(this,b,{}),i(this,h,void 0)}return d(e,[{key:"init",value:function(e){l(v,this)===y&&(a(v,this,e),a(b,this,l(v,this).loadSimidControllerAdapters()),o.g.v(p,"Compatible SIMID controllers: "+Object.keys(l(b,this))))}},{key:"release",value:function(){this.setSimidControllerAdapter(void 0)}},{key:"attachInstance",value:function(e){this.smartLib=e}},{key:"getSimidControllerAdapters",value:function(){return l(b,this)}},{key:"getSimidControllerAdapter",value:function(){return l(h,this)}},{key:"setSimidControllerAdapter",value:function(e){void 0!==l(h,this)&&l(h,this)!==e&&(o.g.i(p,"SIMID controller "+l(h,this).getName()+" detached"),l(h,this).detachSimidController()),l(h,this)!==e?a(h,this,e):void 0!==e&&o.g.i(p,"SIMID controller "+l(h,this).getName()+" already attached"),void 0!==e&&o.g.i(p,"SIMID controller "+e.getName()+" attached")}}],[{key:"getInstance",value:function(){return S._||(S._=new e),S._}}])}(),S={_:void 0};function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,k(n.key),n)}}function k(e){var t=function(e,t){if("object"!=w(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==w(t)?t:t+""}var j="BpkSimidControllerAdapter",I="SIMID:Creative:clickThru",O="SIMID:Player:startCreative",M="createSession",P="resolve",A=function(){return e=function e(){var t,r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,n=void 0,(r=k(r="handler"))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,this.simidSessions={}},t=[{key:"getName",value:function(){return""}},{key:"onMessageSent",value:function(e){var t;try{(t=JSON.parse(e)).messageId=parseInt(t.messageId,10)}catch(e){return void o.g.e(j,"Error: "+e.message)}if(t.type===O){if(void 0===this.simidSessions[t.sessionId])return void o.g.e(j,"Send startCreative message for a uninitialized SIMID session");this.simidSessions[t.sessionId].startMessageId=t.messageId}}},{key:"onMessageReceived",value:function(e){var t,r,n,i;try{(i=JSON.parse(e)).messageId=parseInt(i.messageId,10)}catch(e){return void o.g.e(j,"Error: "+e.message)}switch(i.type){case I:if(void 0===this.simidSessions[i.sessionId])return void o.g.e(j,"Received a clickthru message for a uninitialized SIMID session");null===(t=this.handler)||void 0===t||t.notifySimidClickthrough(i.args);break;case M:if(void 0!==this.simidSessions[i.sessionId])return void o.g.e(j,"SIMID session already created");this.simidSessions[i.sessionId]={id:i.sessionId},o.g.d(j,"SIMID session created with id "+i.sessionId);break;case P:if(void 0===this.simidSessions[i.sessionId])return void o.g.e(j,"Received a resolve message for a uninitialized SIMID session");void 0!==(null===(r=i.args)||void 0===r?void 0:r.messageId)&&(null===(n=i.args)||void 0===n||n.messageId,this.simidSessions[i.sessionId].startMessageId)}}},{key:"attachSimidController",value:function(e,t){return o.g.e(j,"Implementation error: attachSimidController not implemented for this adapter."),!1}},{key:"detachSimidController",value:function(e){return o.g.e(j,"Implementation error: detachSimidController not implemented for this adapter."),!1}},{key:"attachSession",value:function(e){this.handler=e}},{key:"detachSession",value:function(){this.handler=void 0,this.simidSessions={}}}],r=[{key:"checkSimidController",value:function(e){return o.g.e(j,"Implementation error: static checkSimidController not implemented for this adapter."),!1}}],t&&C(e.prototype,t),r&&C(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}(),E=(r(875),r(825),r(1473));function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,L(n.key),n)}}function N(e,t,r){return t=B(t),function(e,t){if(t&&("object"==T(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,D()?Reflect.construct(t,r||[],B(e).constructor):t.apply(e,r))}function D(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(D=function(){return!!e})()}function B(e){return B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},B(e)}function R(e,t){return R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},R(e,t)}function L(e){var t=function(e,t){if("object"!=T(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==T(t)?t:t+""}var W=function(e){function t(){var e,r,n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=N(this,t),r=e,o=void 0,(n=L(n="simidController"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R(e,t)}(t,e),r=t,o=[{key:"checkSimidController",value:function(e){return E.A.hasMethods(e,["getSimidControllerName"])}}],(n=[{key:"getName",value:function(){return this.simidController.getSimidControllerName()}},{key:"attachSimidController",value:function(e,r){return!!t.checkSimidController(e)&&(this.simidController=e,this.simidController.simidControllerAdapter=this,!0)}},{key:"detachSimidController",value:function(){this.simidController=void 0,this.handler=void 0,this.simidSessions={}}}])&&_(r.prototype,n),o&&_(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(A);function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,G(n.key),n)}}function G(e){var t=function(e,t){if("object"!=x(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=x(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==x(t)?t:t+""}var H="BpkGenericSimidControllerApi",J=function(){return e=function e(){var t,r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,n=void 0,(r=G(r="simidControllerAdapter"))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n},(t=[{key:"getSimidControllerName",value:function(){return""}},{key:"onMessageReceived",value:function(e){void 0!==this.simidControllerAdapter?this.simidControllerAdapter.onMessageReceived(e):o.g.e(H,"Implementation error: session.attachSimidController(...) should be called prior to onMessageReceived.")}},{key:"onMessageSent",value:function(e){void 0!==this.simidControllerAdapter?this.simidControllerAdapter.onMessageSent(e):o.g.e(H,"Implementation error: session.attachSimidController(...) should be called prior to onMessageSent.")}}])&&z(e.prototype,t),r&&z(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function F(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,K(n.key),n)}}function K(e){var t=function(e,t){if("object"!=q(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==q(t)?t:t+""}function Q(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function U(e,t){return e.get(V(e,t))}function V(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}r(8140).A.simidModule={SimidControllerManager:g,SimidControllerAdapter:A,GenericSimidControllerAdapter:W,GenericSimidControllerApi:J};var X=new WeakMap,Y=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Q(this,X,void 0)},(t=[{key:"loadSimidControllerAdapters",value:function(){var e,t,r,o;return r=this,o={},(t=X).set(V(t,r),o),U(X,this).generic=W,this.addAdapter("browser",null===(e=n.A.simidModule)||void 0===e?void 0:e.BrowserSimidControllerAdapter),U(X,this)}},{key:"addAdapter",value:function(e,t){void 0!==t&&(U(X,this)[e]=t)}},{key:"attachSimidController",value:function(e,t){for(var r in U(X,this))if(void 0!==U(X,this)[r]&&U(X,this)[r].checkSimidController(e)){var n=new(U(X,this)[r]);return n.attachSimidController(e,t),n}}}])&&F(e.prototype,t),r&&F(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}(),Z=(r(8706),r(8636));function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}function ee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ae(n.key),n)}}function te(e,t,r){return t=ne(t),function(e,t){if(t&&("object"==$(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,re()?Reflect.construct(t,r||[],ne(e).constructor):t.apply(e,r))}function re(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(re=function(){return!!e})()}function ne(e){return ne=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ne(e)}function oe(e,t){return oe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},oe(e,t)}function ie(e,t,r){return(t=ae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ae(e){var t=function(e,t){if("object"!=$(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=$(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$(t)?t:t+""}var le="BpkBrowserSimidControllerAdapter",se=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return ie(e=te(this,t,[].concat(n)),"simidController",void 0),ie(e,"allowedOrigin",void 0),ie(e,"postMessageCallback",void 0),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oe(e,t)}(t,e),r=t,o=[{key:"checkSimidController",value:function(e){var t;return(null==e?void 0:e.setInterval)&&(null==e||null===(t=e.contentWindow)||void 0===t?void 0:t.self)===e.contentWindow}}],(n=[{key:"getName",value:function(){return"Browser SIMID Controller"}},{key:"attachSimidController",value:function(e,r){var n=this;return!!t.checkSimidController(e)&&(void 0===r&&Z.gD.getInstance().printWarnLogs(le,"Messages origin not specified, use at your own risk"),this.postMessageCallback=function(e){e.origin===n.allowedOrigin||void 0===n.allowedOrigin?n.onMessageReceived(e.data):Z.gD.getInstance().printWarnLogs(le,"Message was meant for "+e.origin+", ignoring...")},this.allowedOrigin=r,this.simidController=e,this.simidController.addEventListener("message",this.postMessageCallback),!0)}},{key:"detachSimidController",value:function(){void 0!==this.simidController&&(this.simidController.removeEventListener("message",this.postMessageCallback),this.simidController=void 0,this.allowedOrigin=void 0,this.postMessageCallback=void 0)}}])&&ee(r.prototype,n),o&&ee(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(A);n.A.simidModule={SimidControllerManagerHandler:Y,BrowserSimidControllerAdapter:se,SimidControllerManager:g,GenericSimidControllerApi:J},n.A.getInstance().registerSimidControllerAdapters()}},function(e){return e.O(0,[256,153],(function(){return t=6464,e(e.s=t);var t})),e.O()}])}));